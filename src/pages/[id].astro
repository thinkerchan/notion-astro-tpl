---
import Layout from '../layouts/Layout.astro';
import Footer from '../components/Footer.astro';
import { getApps } from '../utils/notion';
import { marked } from 'marked';
import { SITE } from '../config';
export async function getStaticPaths() {
  const apps = await getApps();
  return apps.map(app => ({
    params: { id: app.id },
    props: { app },
  }));
}

const { app } = Astro.props;
const htmlContent = marked(app.content);
---

<Layout title={`${app.title} | ${SITE.author}`}>
  <main class="max-w-5xl  mx-auto px-4 lg:px-12  py-12">
    <div class="mx-auto bg-white rounded-lg shadow-md p-6">
      <img src={app.icon || '/images/avatar.png'} class="img w-24 h-24 mx-auto mb-4" />
      <h1 class="text-3xl font-bold text-center mb-4">{app.title}</h1>
      <p class="text-gray-600 mb-6 text-center" style="word-break: break-word;">{app.desc}</p>
      <div class="flex flex-wrap justify-center gap-2 mb-6">
        {app.tags.map((tag) => (
          <span
            class="bg-gray-200 text-gray-800 px-1.5 py-0.5 rounded "
            style={`background-color: color-mix(in srgb, ${tag.color} 30%, transparent); box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);`}
          >{tag.name}</span>
        ))}
      </div>

      <a href={app.link} class="block text-center text-blue-500 hover:underline mb-6" target="_blank" style={app.link?'':'display:none;'}>
        👉🏻 {app.link}
      </a>

      <hr class="mb-6">

      <div class="mb-6">
         <div class="markdown-body" set:html={htmlContent}></div>
      </div>

      <div id="Jcomment"></div>
    </div>

    <div class="flex text-gray-400 text-sm align-middle justify-center mt-4" style={ SITE.pv?'':'display:none;'}>
        <span id="busuanzi_container_site_pv">
          @{SITE.author} PV
          <span id="busuanzi_value_site_pv"></span>
        </span>
    </div>

  </main>
  <Footer />
</Layout>